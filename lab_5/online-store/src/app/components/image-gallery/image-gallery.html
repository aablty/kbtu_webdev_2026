<div class="flex flex-col gap-2">
  <button
    type="button"
    class="group relative aspect-square w-full cursor-pointer overflow-hidden rounded-2xl bg-secondary"
    [attr.aria-label]="'View ' + productName() + ' gallery'"
  >
    <img
      [src]="images()[selectedIndex] || '/placeholder.svg'"
      [alt]="productName()"
      class="h-full w-full object-contain transition-transform duration-300 group-hover:scale-105"
    />
    <div
      class="absolute inset-0 flex items-center justify-between px-1 opacity-0 transition-opacity group-hover:opacity-100"
    >
      <button
        type="button"
        (click)="goPrev(); $event.stopPropagation()"
        class="rounded-full bg-card/80 p-1.5 shadow-md backdrop-blur-sm transition-colors hover:bg-card"
        aria-label="Previous image"
      >
        <lucide-icon name="chevron-left" class="h-4 w-4 text-foreground"></lucide-icon>
      </button>
      <button
        type="button"
        (click)="goNext(); $event.stopPropagation()"
        class="rounded-full bg-card/80 p-1.5 shadow-md backdrop-blur-sm transition-colors hover:bg-card"
        aria-label="Next image"
      >
        <lucide-icon name="chevron-right" class="h-4 w-4 text-foreground"></lucide-icon>
      </button>
    </div>
  </button>

  <div class="flex gap-2 p-4">
    @for (img of images(); track $index) {
      <button
        type="button"
        (click)="selectImage($index)"
        [class]="
          'aspect-square w-14 overflow-hidden rounded-lg border-2 transition-all ' +
          ($index === selectedIndex
            ? 'border-primary ring-2 ring-ring/30'
            : 'border-border opacity-60 hover:opacity-100')
        "
        [attr.aria-label]="'View image ' + ($index + 1)"
      >
        <img
          [src]="img || '/placeholder.svg'"
          [alt]="productName() + ' ' + ($index + 1)"
          class="h-full w-full object-contain p-1"
        />
      </button>
    }
  </div>
</div>